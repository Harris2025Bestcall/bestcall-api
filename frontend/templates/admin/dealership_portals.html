{% extends "admin/base_system_ops.html" %}

{% block title %}Dealership Portals - BestCall AI{% endblock %}

{% block content %}
  <h1>Registered Dealership Portals</h1>

  <table border="1" cellpadding="10" cellspacing="0" style="margin-top: 20px; width: 100%;">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Role</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="dealers-table-body">
      <!-- Populated by JS -->
    </tbody>
  </table>

  <script>
    async function loadDealers() {
      const token = localStorage.getItem("access_token");
      const response = await fetch("/admin/users", {
        headers: {
          "Authorization": `Bearer ${token}`
        }
      });
      const users = await response.json();
      const tbody = document.getElementById("dealers-table-body");

      users.forEach(user => {
        const row = document.createElement("tr");

        row.innerHTML = `
          <td>${user.name}</td>
          <td>${user.email}</td>
          <td>${user.role}</td>
          <td>
            <button onclick="alert('Edit functionality coming soon')">Edit</button>
            <button onclick="alert('Delete functionality coming soon')">Delete</button>
          </td>
        `;

        tbody.appendChild(row);
      });
    }

    window.onload = loadDealers;
  </script>
{% endblock %}
