{% extends "base.html" %}
{% block content %}
  <h2 class="page-title">Start Your Review</h2>

  <form id="uploadForm">
    <div class="card full-width">
      <label>ðŸ“„ Upload Credit Application (PDF)</label><br>
      <input type="file" name="credit_app" required /><br><br>

      <label>ðŸ“„ Upload Credit Report (PDF)</label><br>
      <input type="file" name="credit_report" required /><br><br>

      <button type="submit">Start Review</button>
    </div>
  </form>

  <script>
    const form = document.getElementById('uploadForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);

      const res = await fetch("/upload/", {
        method: "POST",
        headers: {
          "x-api-key": "your-api-key-here" // Replace dynamically in future
        },
        body: formData
      });

      const data = await res.json();
      if (data.client_id) {
        window.location.href = `/client/results?client_id=${data.client_id}`;
      } else {
        alert("Upload failed. Please try again.");
      }
    });
  </script>
{% endblock %}
